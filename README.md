# Проект: Предсказание демографических характеристик пользователей на основе просмотров видео

## Описание проекта

Этот проект направлен на создание моделей для предсказания пола и возраста пользователей, исходя из видео, которые они смотрят. Модели используют данные о названиях видео, категориях и других характеристиках, чтобы классифицировать контент по демографическим параметрам пользователей. Основные этапы работы включают разведочный анализ данных (EDA), генерацию эмбеддингов и обучение моделей машинного обучения.

### Основные этапы:
1. **Разведочный анализ данных (EDA)**  
   Исследование статистики просмотров видео и поведения пользователей. По итогам EDA сгенерированы дополнительные фичи, которые улучшают качество моделей.

2. **Генерация эмбеддингов для видео**  
   - Используются модели **SentenceTransformer** и **XLM-Roberta** для преобразования названий видео в эмбеддинги. Эти эмбеддинги служат основой для классификации видео по демографическим характеристикам пользователей.

3. **Обучение моделей**  
   - Основные модели построены с помощью **CatBoost** для предсказания пола и возраста пользователей. Модели обучаются с использованием кросс-валидации (Out-of-Fold) для повышения стабильности результатов и создания новых фичей.
   - Для предсказания пола модель классифицирует видео на три категории: предпочитаемые женщинами, мужчинами или нейтральные.
   - Предсказание возраста осуществляется как через классификацию по возрастным группам, так и через регрессию для предсказания медианного возраста.

4. **Фичи**  
   - Фичи включают популярность видео, временные паттерны просмотра, предпочтения по авторам и категориям, устройства и платформы, используемые пользователями, а также текстовые фичи на основе эмбеддингов названий видео.

### Результаты:
- **ROC-AUC до 0.92** для классификации пола и **0.87** для предсказания возраста у пользователей, которые просмотрели более 6 видео.
- Модели продемонстрировали высокую стабильность и точность на всех фолдах кросс-валидации.

## Структура репозитория

- `EDA_v1.ipynb`, `EDA_v2.ipynb`: файлы для разведочного анализа данных.
- `SentenceTransformer.ipynb`: модель для генерации эмбеддингов видео на основе названий с использованием модели `intfloat/multilingual-e5-small`.
- `videotitle_baseline_v2.ipynb`: обучение линейных моделей для предсказания пола и возраста на основе эмбеддингов от **XLM-Roberta**.
- `baseline_v6.ipynb`: основной файл для обучения финальных моделей с использованием CatBoost для предсказания пола и возраста.
- Результаты моделей хранятся в файлах `video_info_v2_emb_E5.parquet`, `cv_TRAIN_category_users_df.csv`, `cv_TRAIN_title_users_df.csv`, ```[video_info_v2_emb_E5.parque](https://disk.yandex.ru/d/z-Xm4qhGauQCFA)``` и других.


## Как запустить проект

1. Склонируйте репозиторий:
   ```bash
   git clone [https://github.com/your-repo-name.git](https://github.com/DimkKozhem/Skripka_CP)
   ```
   
2. Установите необходимые зависимости:
   ```bash
   pip install -r requirements.txt
   ```

3. Откройте и выполните ноутбуки по порядку:
   - Начните с **EDA** файлов для исследования данных.
   - Продолжите с ноутбуков, связанных с обучением эмбеддингов и моделей.

4. Запустите обучение моделей с использованием файлов 
для финальных предсказаний.

## Зависимости

- Python 3.x
- SentenceTransformer
- XLM-Roberta
- CatBoost
- pandas, numpy, scikit-learn

## Лицензия

Проект распространяется под лицензией MIT.
